<!DOCTYPE html><html><head>   <meta>     <title>Verity data on a bank callback with public_key</title>   </meta>   <style>
.youtube_player_container {
    position: relative;
    width: 50%;
    padding-bottom: 26.25%;
    /* background-color: yellow; */
}
.youtube_player_frame {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 0;
}
       </style></head><body><a href="index.html"><h2>Index</h2></a><a href="https://www.reddit.com/r/django/comments/1ffpg5d/verity_data_on_a_bank_callback_with_public_key"><h1>[1139212] Verity data on a bank callback with public_key</h1></a><div>https://www.reddit.com/r/django/.rss</div><div>2024-09-13 14:40:55.579736+00:00</div><div><pre><!-- SC_OFF --><div><p>Hello,</p> <p>I'm implementing a bank payment system, the cards are charged and after this I'm getting callback from a bank with status, but before check a status I must check that this callback is from the bank.<br/> I'm getting a request.headers["Callback-Signature"], which is "mZ5LBXssN ... OallmdUA=="<br/> The body - request.body = b'{ SOME JSON DATA }'<br/> And a bank has a Public key on an API documentation</p> <p>(A Public key has these header and footer: -----BEGIN PUBLIC KEY----- და -----END PUBLIC KEY-----, I save this key without these header and footer, so I use load_der_public_key and not load_pem_public_key)</p> <p>And the bank is using <code>SHA256withRSA</code> algorithm. </p> <p>So this is my code:</p> <p><code>public_key = serialization.load_der_public_key(base64.b64decode(settings.BANK_PUBLIC_KEY))</code><br/> <code>signature = base64.b64decode(request.headers["Callback-Signature"])&lt;</code></p></div></pre></div></body></html>